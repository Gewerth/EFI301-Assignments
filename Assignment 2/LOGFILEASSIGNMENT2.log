--------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /Users/gustaf/Documents/GitHub/EFI301-Assignments/Assignment 2/LOGFILEASSIGNMEN
> T2.log
  log type:  text
 opened on:  30 Jan 2023, 18:21:06

. 
. ********************************************************************************
. 
. /*
> Now start your analysis. 
> - Clearly label each answer.
> - for questions that require a text reply give your answer in a comment block.
> */
. 
. /*  Problem 6
>         1.  Consider the following model of demand on a given airline route
>                         log(passen) = β0 + β1 log(fare) + U.                              
>     (1)
>                 a, Interpret the coefficient β1.
>                         if the fare increse by β1 % then the  number of passengers increas
> e  by 1%.            β1  is  the relation between fare and passengers. 
>                 b, Estimate the model. */
.                 gen lpas =log(passen)

.                 gen lfare =log(fare)

.                 regress lpas lfare

      Source |       SS           df       MS      Number of obs   =     1,149
-------------+----------------------------------   F(1, 1147)      =     57.82
       Model |  46.2934836         1  46.2934836   Prob > F        =    0.0000
    Residual |  918.321147     1,147  .800628725   R-squared       =    0.0480
-------------+----------------------------------   Adj R-squared   =    0.0472
       Total |  964.614631     1,148  .840256647   Root MSE        =    .89478

------------------------------------------------------------------------------
        lpas | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       lfare |  -.4815181    .063324    -7.60   0.000    -.6057619   -.3572742
       _cons |   8.540983   .3273545    26.09   0.000     7.898703    9.183264
------------------------------------------------------------------------------

. /*      lpas | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
> -------------+----------------------------------------------------------------
>        lfare |  -.4815181    .063324    -7.60   0.000    -.6057619   -.3572742
>        _cons |   8.540983   .3273545    26.09   0.000     7.898703    9.183264
> ------------------------------------------------------------------------------
>                 
> */
. /*
>         2. Our application here is an example of demand estimation in a many markets frame
> work. What is a market in our application? 
>         ## The market is the airline market, where buyers, buy seats from airlines. ##*/
.          
. /*      3. In the model above, we do not control explicitly for the distance between the  
>       airport of origin and the destination. Suppose that model in problem 6.1 can be rewr
> itten as
>                 log(passen) = β0 + β1 log(fare) + β2 log(dist) + V                   (2)
> where the demand shock V satisfies the exogeneity assumption
>                 E[V | log(fare), log(dist)] = E[V | fare, dist] = 0.            (3)
>                 a) Rewrite U from equation in (1) as a function of dist and V .*/
.                 /*      β0 + β1 log(fare) + U =        β0 + β1 log(fare) + β2 log(dist) + 
> V                */
.                 /*                                              U =  β2 log(dist) + V     
>                                              */
. /*              b) Use this representation of U to state the exogeneity condition for OLS 
> estima-
> tion of model (1). */
.         
.         /*      Cov(fare, V) = 0        (I)
>         Using U = inserted into (I) we get Cov(fare, β2*log(dist) + U)  = -β2* Cov(fare,  
> log(dist) + cov(fare, U))= β2* Cov(fare, log(dist))=0*/
. 
. /*              c) Is it plausible that this exogeneity assumption is satisfied? Explain.*
> /
.                 /* For this to hold, either β2=0 or there is no covariance between fare an
> d distance, the latter is more plausible, however some quick googling finds greater differ
> nece between prices the longer the flights are, indcating that it inprobable that the exog
> enity assumption is satisfied. 
> 
> /*      4. We will now try to sign the bias that we face if the true model is (2) and we e
> stimate β1 by fitting (1) by OLS. You may assume that we have a "large sample".
>                 a) Adapt the formula for omitted variable bias to this scenario.*/
>                 Cov(log(fare),log(dist))/var(log(fare))*β2 */
.         
. /*              b) What sign do you expect for β2?*/
.                 /* We expect that the number of people who fly 10+h flights is smaller tha
> n the number of people who fly 2h flights.  Hence we expect β2<0 */
. 
. /*              c) What sign do you expect for the covariance between log(fare) and log(di
> st)? */
. gen ldist = log(dist)

. correlate lfare ldist, covariance
(obs=1,149)

             |    lfare    ldist
-------------+------------------
       lfare |  .173921
       ldist |  .160316  .434984


.                 /*After some googleing of aiirfares, we've seen that the variance in price
>  increses the longer the travle is. This would indicate that the covarience is positive.*/
. /*              d) What sign do you expect for the omitted variable bias? */
.                 /*since the denumerator is >0 by definition and the nominator is >0 and  β
> 2<0 the OV-bias has a negative sign. */
. 
. /*      5. We have data on dist and can estimate (2). Compare the the OLS estimates for th
> e effect of log(fare) from the two models. Is your conjecture about the sign of the omitte
> d variable bias confirmed?*/
. regress lpas lfare

      Source |       SS           df       MS      Number of obs   =     1,149
-------------+----------------------------------   F(1, 1147)      =     57.82
       Model |  46.2934836         1  46.2934836   Prob > F        =    0.0000
    Residual |  918.321147     1,147  .800628725   R-squared       =    0.0480
-------------+----------------------------------   Adj R-squared   =    0.0472
       Total |  964.614631     1,148  .840256647   Root MSE        =    .89478

------------------------------------------------------------------------------
        lpas | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       lfare |  -.4815181    .063324    -7.60   0.000    -.6057619   -.3572742
       _cons |   8.540983   .3273545    26.09   0.000     7.898703    9.183264
------------------------------------------------------------------------------

. /*
> ----------------------------------------------------------------------------
>         lpas | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
> -------------+----------------------------------------------------------------
>        lfare |  -.4815181    .063324    -7.60   0.000    -.6057619   -.3572742
>        _cons |   8.540983   .3273545    26.09   0.000     7.898703    9.183264
> ------------------------------------------------------------------------------
> */
. 
. regress lpas lfare ldist

      Source |       SS           df       MS      Number of obs   =     1,149
-------------+----------------------------------   F(2, 1146)      =     33.30
       Model |  52.9826221         2   26.491311   Prob > F        =    0.0000
    Residual |  911.632009     1,146  .795490409   R-squared       =    0.0549
-------------+----------------------------------   Adj R-squared   =    0.0533
       Total |  964.614631     1,148  .840256647   Root MSE        =     .8919

------------------------------------------------------------------------------
        lpas | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       lfare |  -.6128103   .0776797    -7.89   0.000    -.7652208   -.4603999
       ldist |   .1424345   .0491188     2.90   0.004     .0460617    .2388073
       _cons |   8.263681   .3400264    24.30   0.000     7.596537    8.930825
------------------------------------------------------------------------------

. /*
> 
>    lpas | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
> -------------+----------------------------------------------------------------
>        lfare |  -.6128103   .0776797    -7.89   0.000    -.7652208   -.4603999
>        ldist |   .1424345   .0491188     2.90   0.004     .0460617    .2388073
>        _cons |   8.263681   .3400264    24.30   0.000     7.596537    8.930825
> ------------------------------------------------------------------------------
> */
. /* No, we were wrong about the sign of β2, it was infact ngative. */
. 
. /*      6. Verify that the slope coefficient from fitting model (1) by OLS is equal to βˆ 
> + δˆ βˆ,1 log(dist)|log(fare) 2
> where βˆ1 and βˆ2 are the OLS estimates obtained by fitting model (2) and
> δˆ = cdov(log(dist),log(fare)) log(dist)|log(fare) vcar(log(fare))
> is the slope coefficient from a regression of log(dist) on log(fare). */
. 
. 
. /*Problem 7 
> For this problem we continue to use the data from Problem 6. */
. /*      1. Generate new variables lpassen, lfare and ldist for logged passen, fare and
> dist, respectively (if you haven't done so already).*/
. 
. /*      2. Fares for air travel are determined in a competitive market by the laws of supp
> ly and demand. Explain intuitively why this renders the exogeneity assumption (3) implausi
> ble.*/
. 
.  
. /*      3. The data set "airconc00.dta" contains for each route the variable bmktshr which
>  gives the market share of the airline with the largest market share on this route. This i
> s a measure of the concentration of market power on a given route.*/
. 
. /*              a) Explain in intuitive terms (drawing from your knowledge of economic the
> ory) how bmktshr influences the supply side of the market.*/
. 
. /*              b) Suppose that one carrier stops providing service on a route so that bmk
> tshr for this route increases. What happens to the supply curve for this route? What happe
> ns to the ticket price? Is the price change informative about the demand shock?*/
. 
. /*      4. We want to import the variable bmktshr into our dataset. */
. /*              a) Type help merge to learn about the syntax of the stata command merge.*/
. 
. /*              b) Run "merge 1:1 route using airconc00.dta" and explain the meaning of th
> is command. */
. 
. /*              c) How does your dataset change? */
. 
. /*              d) Why do you have to specify "route"?*/
. 
. /*      5. We want to estimate the structural equation (2) by instrumental variable regres
> sion.*/
. /*              a) State the instrument relevance condition for using bmtshr as an instrum
> ent for lfare. Hint: The structural equation contains a control variable!*/
. 
. /*              b) Do you expect it to be satisfied? Explain.*/
. 
. /*              c) Run the first stage and use the regression output to conduct a statisti
> cal test
> of the instrument relevance condition (α = 0.05). */
. 
. /*              d) Now we want to develop a hypothetical setting in which the instrument
> relevance assumption is not satisfied and in which we still have cov(bmtshr, log(fare)) ̸=
>  0.
> Assume that passengers are willing to spend more money the longer the distance travelled. 
> What would the joint distribution of log(dist) and bmtshr have to look like to ensure that
>  that
>     cov(bmtshr, log(fare)) < 0. */
.         
. /*      6. */
. /*              a) State the appropriate instrument exogeneity assumption.*/
.         
. /*              b) Do you expect it to be satisfied? Explain.*/
. 
. 
. /*      7. Instruments like market share that affect the supply side of the market are cal
> led "supply shifters". Supply shifters are often used to estimate demand parameters.
> Explain briefly in intuitive terms*/
. /*              a) why a supply shifter is a relevant instrument. */
. 
. /*              b) under what conditions a supply shifter satisfies the instrument exogene
> ity assumption.*/
. 
. /*      8. The Stata command ivregress computes the IV estimates βˆiv(ω0) and βˆiv(ω0). 12
> The output of ivregress also reports correct standard errors for the estimated coefficient
> s. The Stata command to fit the IV regression is
> ivregress 2sls lpassen ldist (lfare = bmktshr), robust*/
. /*              a) Run the IV regression and compare the estimated coefficient βˆiv(ω0) to
>  the
> OLS estimate βˆols(ω0) that we obtained by fitting (2) by OLS. 1 */
. 
. /*              b) Give an econometric explanation for the different estimates. */
. 
. /*      9. Now we want to compute the IV estimate βˆiv(ω0) by implementing the two-stage
> least squares (2SLS) protocol. */
. 
. /*              a) Run the first-stage regression and store the fitted values from this re
> gression in a new variable lfare hat. (Hint: use the command predict with the option xb).*
> /
. 
. /*              b) Run the second-stage regression and verify that you get the same estima
> tes as you get by using the ivregress command.*/
. 
. /*              c) Compare the standard errors reported at the second stage to the standar
> d errors computed by ivregress. Explain. */
. 
. 
. 
. 
. 
. 
. 
. 
. 
. 
. 
. 
. ********************************************************************************
. 
. /* 
> At the end of the do-file, usually you'd want to save the changed data set 
> under a different name (don’t overwrite the original file!).
> */
. save NEWDATAFILENAME2, replace
file NEWDATAFILENAME2.dta saved

. 
. // Close the log-file.
. log close 
      name:  <unnamed>
       log:  /Users/gustaf/Documents/GitHub/EFI301-Assignments/Assignment 2/LOGFILEASSIGNMEN
> T2.log
  log type:  text
 closed on:  30 Jan 2023, 18:21:06
--------------------------------------------------------------------------------------------
